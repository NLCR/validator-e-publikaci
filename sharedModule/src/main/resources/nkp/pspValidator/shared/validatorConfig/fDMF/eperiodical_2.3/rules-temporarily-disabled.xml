<fDMF xmlns="http://www.nkp.cz/validatorEpublikaci/1.1/fdmfConfig"
      validatorVersion="1.1"
      dmf="eperiodical_2.3"
>
    <description>
        Zde jsou definovány validační pravidla. K samotným validacím se používají validační funkce, jejichž parametry
        jsou definované proměnné, vzory a konstanty.
        Pravidla je možné dynamicky doplňovat/upravovat, ale je vždy nutné používat existující proměnné a vzory.
    </description>

    <rules-section name="Primární METS filesec" description="">

        <rule name="PRIMARY-METS_FILESEC_ALL_FILEGROUPS_PRESENT">
            <description>Element mets:fileSec v souboru PRIMARY-METS musí obsahovat elementy mets:fileGrp s definovanými
                hodnotami ID a USE a žádné další.
            </description>
            <validation functionName="checkPrimaryMetsFilesecContainsAllFilegroups">
                <params>
                    <value name="primary-mets_file" type="FILE">
                        <value-ref name="PRIMARY-METS_FILE"/>
                    </value>
                </params>
            </validation>
        </rule>

        <rule name="PRIMARY-METS_FILESEC_ALL_MASTER_COPY_FILES_REFERENCED">
            <description>Element mets:fileSec v souboru PRIMARY-METS musí v elementu mets:fileGrp s atributem
                ID="MC_IMGGRP" obsahovat odkazy na všechny soubory MASTER-COPY a žádné jiné.
            </description>
            <validation functionName="checkFileListsMatch">
                <params>
                    <value name="expected_files" type="FILE_LIST">
                        <value-ref name="MASTER-COPY_FILES"/>
                    </value>
                    <value name="found_files" type="FILE_LIST">
                        <evaluation functionName="getFileListByXpath">
                            <params>
                                <value name="psp_dir" type="FILE">
                                    <value-ref name="PSP_DIR"/>
                                </value>

                                <value name="xml_file" type="FILE">
                                    <value-ref name="PRIMARY-METS_FILE"/>
                                </value>
                                <value name="xpath" type="STRING">
                                    /mets:mets/mets:fileSec/mets:fileGrp[@ID='MC_IMGGRP']/mets:file/mets:FLocat[@LOCTYPE='URL']/@xlink:href
                                </value>
                            </params>
                        </evaluation>
                    </value>
                </params>
            </validation>
        </rule>

        <rule name="PRIMARY-METS_FILESEC_ALL_USER_COPY_FILES_REFERENCED">
            <description>Element mets:fileSec v souboru PRIMARY-METS musí v elementu mets:fileGrp s atributem
                ID="UC_IMGGRP" obsahovat odkazy na všechny soubory USER-COPY a žádné jiné.
            </description>
            <validation functionName="checkFileListsMatch">
                <params>
                    <value name="expected_files" type="FILE_LIST">
                        <value-ref name="USER-COPY_FILES"/>
                    </value>
                    <value name="found_files" type="FILE_LIST">
                        <evaluation functionName="getFileListByXpath">
                            <params>
                                <value name="psp_dir" type="FILE">
                                    <value-ref name="PSP_DIR"/>
                                </value>

                                <value name="xml_file" type="FILE">
                                    <value-ref name="PRIMARY-METS_FILE"/>
                                </value>
                                <value name="xpath" type="STRING">
                                    /mets:mets/mets:fileSec/mets:fileGrp[@ID='UC_IMGGRP']/mets:file/mets:FLocat[@LOCTYPE='URL']/@xlink:href
                                </value>
                            </params>
                        </evaluation>
                    </value>
                </params>
            </validation>
        </rule>

        <rule name="PRIMARY-METS_FILESEC_ALL_OCR_TEXT_FILES_REFERENCED">
            <description>Element mets:fileSec v souboru PRIMARY-METS musí v elementu mets:fileGrp s atributem
                ID="TXTGRP" obsahovat odkazy na všechny soubory OCR-TEXT a žádné jiné.
            </description>
            <validation functionName="checkFileListsMatch">
                <params>
                    <value name="expected_files" type="FILE_LIST">
                        <value-ref name="OCR-TEXT_FILES"/>
                    </value>
                    <value name="found_files" type="FILE_LIST">
                        <evaluation functionName="getFileListByXpath">
                            <params>
                                <value name="psp_dir" type="FILE">
                                    <value-ref name="PSP_DIR"/>
                                </value>

                                <value name="xml_file" type="FILE">
                                    <value-ref name="PRIMARY-METS_FILE"/>
                                </value>
                                <value name="xpath" type="STRING">
                                    /mets:mets/mets:fileSec/mets:fileGrp[@ID='TXTGRP']/mets:file/mets:FLocat[@LOCTYPE='URL']/@xlink:href
                                </value>
                            </params>
                        </evaluation>
                    </value>
                </params>
            </validation>
        </rule>

        <rule name="PRIMARY-METS_FILESEC_ALL_OCR_ALTO_FILES_REFERENCED">
            <description>Element mets:fileSec v souboru PRIMARY-METS musí v elementu mets:fileGrp s atributem
                ID="ALTOGRP" obsahovat odkazy na všechny soubory OCR-ALTO a žádné jiné.
            </description>
            <validation functionName="checkFileListsMatch">
                <params>
                    <value name="expected_files" type="FILE_LIST">
                        <value-ref name="OCR-ALTO_FILES"/>
                    </value>
                    <value name="found_files" type="FILE_LIST">
                        <evaluation functionName="getFileListByXpath">
                            <params>
                                <value name="psp_dir" type="FILE">
                                    <value-ref name="PSP_DIR"/>
                                </value>

                                <value name="xml_file" type="FILE">
                                    <value-ref name="PRIMARY-METS_FILE"/>
                                </value>
                                <value name="xpath" type="STRING">
                                    /mets:mets/mets:fileSec/mets:fileGrp[@ID='ALTOGRP']/mets:file/mets:FLocat[@LOCTYPE='URL']/@xlink:href
                                </value>
                            </params>
                        </evaluation>
                    </value>
                </params>
            </validation>
        </rule>

        <rule name="PRIMARY-METS_FILESEC_ALL_SECONDARY_METS_FILES_REFERENCED">
            <description>Element mets:fileSec v souboru PRIMARY-METS musí v elementu mets:fileGrp s atributem
                ID="TECHMDGRP" obsahovat odkazy na všechny soubory SECONDARY-METS a žádné jiné.
            </description>
            <validation functionName="checkFileListsMatch">
                <params>
                    <value name="expected_files" type="FILE_LIST">
                        <value-ref name="SECONDARY-METS_FILES"/>
                    </value>
                    <value name="found_files" type="FILE_LIST">
                        <evaluation functionName="getFileListByXpath">
                            <params>
                                <value name="psp_dir" type="FILE">
                                    <value-ref name="PSP_DIR"/>
                                </value>
                                <value name="xml_file" type="FILE">
                                    <value-ref name="PRIMARY-METS_FILE"/>
                                </value>
                                <value name="xpath" type="STRING">
                                    /mets:mets/mets:fileSec/mets:fileGrp[@ID='TECHMDGRP']/mets:file/mets:FLocat[@LOCTYPE='URL']/@xlink:href
                                </value>
                            </params>
                        </evaluation>
                    </value>
                </params>
            </validation>
        </rule>

        <rule name="PRIMARY-METS_FILESEC_ALL_SECONDARY_METS_FILES_REFERENCED">
            <description>Element mets:fileSec v souboru PRIMARY-METS musí v elementu mets:fileGrp s atributem
                ID="TECHMDGRP" obsahovat odkazy na všechny soubory SECONDARY-METS a žádné jiné.
            </description>
            <validation functionName="checkFileListsMatch">
                <params>
                    <value name="expected_files" type="FILE_LIST">
                        <value-ref name="SECONDARY-METS_FILES"/>
                    </value>
                    <value name="found_files" type="FILE_LIST">
                        <evaluation functionName="getFileListByXpath">
                            <params>
                                <value name="psp_dir" type="FILE">
                                    <value-ref name="PSP_DIR"/>
                                </value>
                                <value name="xml_file" type="FILE">
                                    <value-ref name="PRIMARY-METS_FILE"/>
                                </value>
                                <value name="xpath" type="STRING">
                                    /mets:mets/mets:fileSec/mets:fileGrp[@ID='TECHMDGRP']/mets:file/mets:FLocat[@LOCTYPE='URL']/@xlink:href
                                </value>
                            </params>
                        </evaluation>
                    </value>
                </params>
            </validation>
        </rule>

        <rule name="PRIMARY-METS_FILESEC_SIZES_MATCH">
            <description>Velikosti souborů v bytech uvedené v atributu SIZE všech elementů mets:file se musí shodovat se
                skutečnými velikostmi souborů odkazovaných v elementech mets:FLocat.
            </description>
            <validation functionName="checkMetsFilesecSizesMatch">
                <params>
                    <value name="psp_dir" type="FILE">
                        <value-ref name="PSP_DIR"/>
                    </value>
                    <value name="mets_file" type="FILE">
                        <value-ref name="PRIMARY-METS_FILE"/>
                    </value>
                </params>
            </validation>
        </rule>

        <rule name="PRIMARY-METS_FILESEC_CHECKSUMS_MATCH">
            <description>Kontrolní součty souborů uvedené v atributu CHECKSUM všech elementů mets:file se musí shodovat
                s vypočítanými kontrolními součty souborů odkazovaných v elementech mets:FLocat.
            </description>
            <validation functionName="checkMetsFilesecChecksumsMatch">
                <params>
                    <value name="psp_dir" type="FILE">
                        <value-ref name="PSP_DIR"/>
                    </value>
                    <value name="mets_file" type="FILE">
                        <value-ref name="PRIMARY-METS_FILE"/>
                    </value>
                </params>
            </validation>
        </rule>

    </rules-section>

    <rules-section name="Sekundární METS filesec"
                   description="Sekce mets:fileSec v sekundárních METS souborech musí obsahovat korektní odkazy na soubory s popisy jednotlivých stran (master a user kopie, textové a alto ocr)">

        <rule name="SECONDARY-METS_FILESEC_ALL_FILEGROUPS_PRESENT">
            <description>Element mets:fileSec v každém souboru SECONDARY-METS musí obsahovat elementy mets:fileGrp s
                definovanými hodnotami atributů ID a USE a žádné další.
            </description>
            <validation functionName="checkSecondaryMetsFilesecContainsAllFilegroups">
                <params>
                    <value name="secondary-mets_files" type="FILE_LIST">
                        <value-ref name="SECONDARY-METS_FILES"/>
                    </value>
                </params>
            </validation>
        </rule>

        <rule name="SECONDARY-METS_FILESEC_MASTER_COPY_FILE_REFERENCED">
            <description>Element mets:fileSec v každém souboru SECONDARY-METS musí v elementu mets:fileGrp s atributem
                ID="MC_IMGGRP" obsahovat odkaz na správný soubor MASTER-COPY a žádné jiné odkazy.
            </description>
            <validation functionName="checkSecondaryMetsFilegroupReferencesSingleFile">
                <params>
                    <value name="psp_dir" type="FILE">
                        <value-ref name="PSP_DIR"/>
                    </value>
                    <value name="secondary-mets_files" type="FILE_LIST">
                        <value-ref name="SECONDARY-METS_FILES"/>
                    </value>
                    <value name="referenced_files" type="FILE_LIST">
                        <value-ref name="MASTER-COPY_FILES"/>
                    </value>
                    <value name="filegroup_id" type="STRING">MC_IMGGRP</value>
                </params>
            </validation>
        </rule>

        <rule name="SECONDARY-METS_FILESEC_USER_COPY_FILE_REFERENCED">
            <description>Element mets:fileSec v každém souboru SECONDARY-METS musí v elementu mets:fileGrp s atributem
                ID="UC_IMGGRP" obsahovat odkaz na správný soubor USER-COPY a žádné jiné odkazy.
            </description>
            <validation functionName="checkSecondaryMetsFilegroupReferencesSingleFile">
                <params>
                    <value name="psp_dir" type="FILE">
                        <value-ref name="PSP_DIR"/>
                    </value>
                    <value name="secondary-mets_files" type="FILE_LIST">
                        <value-ref name="SECONDARY-METS_FILES"/>
                    </value>
                    <value name="referenced_files" type="FILE_LIST">
                        <value-ref name="USER-COPY_FILES"/>
                    </value>
                    <value name="filegroup_id" type="STRING">UC_IMGGRP</value>
                </params>
            </validation>
        </rule>

        <rule name="SECONDARY-METS_FILESEC_OCR-ALTO_FILE_REFERENCED">
            <description>Element mets:fileSec v každém souboru SECONDARY-METS musí v elementu mets:fileGrp s atributem
                ID="ALTOGRP" obsahovat odkaz na správný soubor OCR-ALTO a žádné jiné odkazy.
            </description>
            <validation functionName="checkSecondaryMetsFilegroupReferencesSingleFile">
                <params>
                    <value name="psp_dir" type="FILE">
                        <value-ref name="PSP_DIR"/>
                    </value>
                    <value name="secondary-mets_files" type="FILE_LIST">
                        <value-ref name="SECONDARY-METS_FILES"/>
                    </value>
                    <value name="referenced_files" type="FILE_LIST">
                        <value-ref name="OCR-ALTO_FILES"/>
                    </value>
                    <value name="filegroup_id" type="STRING">ALTOGRP</value>
                </params>
            </validation>
        </rule>

        <rule name="SECONDARY-METS_FILESEC_OCR-TEXT_FILE_REFERENCED">
            <description>Element mets:fileSec v každém souboru SECONDARY-METS musí v elementu mets:fileGrp s atributem
                ID="TXTGRP" obsahovat odkaz na správný soubor OCR-TEXT a žádné jiné odkazy.
            </description>
            <validation functionName="checkSecondaryMetsFilegroupReferencesSingleFile">
                <params>
                    <value name="psp_dir" type="FILE">
                        <value-ref name="PSP_DIR"/>
                    </value>
                    <value name="secondary-mets_files" type="FILE_LIST">
                        <value-ref name="SECONDARY-METS_FILES"/>
                    </value>
                    <value name="referenced_files" type="FILE_LIST">
                        <value-ref name="OCR-TEXT_FILES"/>
                    </value>
                    <value name="filegroup_id" type="STRING">TXTGRP</value>
                </params>
            </validation>
        </rule>

    </rules-section>

    <rules-section name="Strukturální mapy"
                   description="Kontrola fyzických a logických strukturálních map v METS záznamech">

        <rule name="PRIMARY-METS_LOGICAL_STRUCTURAL_MAP_CORRECT">
            <description>Logická strukturální mapa v souboru PRIMARY-METS musí odkazovat jen na povolené typy obsahu a
                DMDID musí odkazovat na existující metadataové záznamy.
            </description>
            <validation functionName="checkPrimaryMetsLogicalMapOk">
                <params>
                    <value name="primary-mets_file" type="FILE">
                        <value-ref name="PRIMARY-METS_FILE"/>
                    </value>
                    <value name="div_types_allowed" type="STRING_LIST">
                        <evaluation functionName="buildListOfStrings">
                            <params>
                                <value name="string" type="STRING">PERIODICAL_TITLE</value>
                                <value name="string" type="STRING">PERIODICAL_VOLUME</value>
                                <value name="string" type="STRING">ISSUE</value>
                                <value name="string" type="STRING">SUPPLEMENT</value>
                                <value name="string" type="STRING">ARTICLE</value>
                                <value name="string" type="STRING">TITLE</value>
                                <value name="string" type="STRING">SUBTITLE</value>
                                <value name="string" type="STRING">AUTHOR</value>
                                <value name="string" type="STRING">TRANSLATOR</value>
                                <value name="string" type="STRING">NORMAL_TEXT</value>
                                <value name="string" type="STRING">PICTURE</value>
                                <value name="string" type="STRING">NOTE</value>
                                <value name="string" type="STRING">ARTICLE_PART</value>
                                <value name="string" type="STRING">CAPTION</value>
                                <value name="string" type="STRING">PICT_AUTHOR</value>
                                <value name="string" type="STRING">PICT_TITLE</value>
                                <value name="string" type="STRING">IMAGE</value>
                                <value name="string" type="STRING">PAGE</value>
                            </params>
                        </evaluation>
                    </value>
                </params>
            </validation>
        </rule>

        <rule name="PRIMARY-METS_STRUCT_LINKS_CORRECT">
            <description>Sekce structLink v souboru PRIMARY-METS musí přes elementy smLink propojovat objekty logické
                strukturální mapy se stranami z fyzické strukturální mapy.
            </description>
            <validation functionName="checkPrimaryMetsStructLinksOk">
                <params>
                    <value name="primary-mets_file" type="FILE">
                        <value-ref name="PRIMARY-METS_FILE"/>
                    </value>
                </params>
            </validation>
        </rule>

        <rule name="PRIMARY-METS_PHYSICAL_STRUCTURAL_MAP_CORRECT">
            <description>Fyzická strukturální mapa v souboru PRIMARY-METS musí korektně odkazovat na všechny soubory
                odkazované v elementu fileSec a žádné jiné.
            </description>
            <validation functionName="checkPrimaryMetsPhysicalMapOk">
                <params>
                    <value name="primary-mets_file" type="FILE">
                        <value-ref name="PRIMARY-METS_FILE"/>
                    </value>
                    <!--Ze specifikace není jednoznačně zřejmé, jak plnit atribut TYPE- zda periodical nebo Periodical, proto dočasně zakomentováno-->
                    <!--<value name="expected_top_level_div_type" type="STRING">Periodical</value>-->
                    <value name="filegroups_to_check" type="STRING_LIST">
                        <evaluation functionName="buildListOfStrings">
                            <params>
                                <value name="string" type="STRING">MC_IMGGRP</value>
                                <value name="string" type="STRING">UC_IMGGRP</value>
                                <value name="string" type="STRING">ALTOGRP</value>
                                <value name="string" type="STRING">TXTGRP</value>
                                <value name="string" type="STRING">TECHMDGRP</value>
                            </params>
                        </evaluation>
                    </value>
                    <value name="page_types" type="STRING_LIST">
                        <evaluation functionName="buildListOfStrings">
                            <params>
                                <!--https://docs.google.com/document/d/1zSriHPdnUY5d_tKv0M8a6nEym560DKh2H6XZ24tGAEw/edit?pli=1#heading=h.g5ucgez1xrbr-->
                                <!--základní typy-->
                                <value name="string" type="STRING">titlePage</value>
                                <value name="string" type="STRING">tableOfContents</value>
                                <value name="string" type="STRING">blank</value>
                                <value name="string" type="STRING">advertisement</value>
                                <value name="string" type="STRING">normalPage</value>
                                <value name="string" type="STRING">jacket</value>
                                <value name="string" type="STRING">cover</value>
                                <value name="string" type="STRING">frontCover</value>
                                <value name="string" type="STRING">frontMatter</value>
                                <value name="string" type="STRING">backCover</value>
                                <value name="string" type="STRING">backMatter</value>
                                <value name="string" type="STRING">frontEndSheet</value>
                                <value name="string" type="STRING">backEndSheet</value>
                                <value name="string" type="STRING">spine</value>
                                <value name="string" type="STRING">frontJacket</value>

                                <!--další typy-->
                                <value name="string" type="STRING">index</value>
                                <value name="string" type="STRING">illustration</value>
                                <value name="string" type="STRING">listOfIllustrations</value>
                                <value name="string" type="STRING">map</value>
                                <value name="string" type="STRING">listOfMaps</value>
                                <value name="string" type="STRING">listOfTables</value>
                                <value name="string" type="STRING">table</value>
                                <value name="string" type="STRING">flyLeaf</value>
                                <value name="string" type="STRING">dedication</value>
                                <value name="string" type="STRING">errata</value>
                                <value name="string" type="STRING">frontispiece</value>
                                <value name="string" type="STRING">edge</value>
                                <value name="string" type="STRING">printPermission</value>
                                <value name="string" type="STRING">appendix</value>
                                <value name="string" type="STRING">bibliography</value>
                                <value name="string" type="STRING">sheetMusic</value>
                                <value name="string" type="STRING">impressum</value>


                                <!--Další možné typy stran pro vnitřní část dokumentu-article, doplněno z Pravidel pro popis periodik v. 8.3.1-->
                                <value name="string" type="STRING">news</value>
                                <value name="string" type="STRING">abstract</value>
                                <value name="string" type="STRING">introduction</value>
                                <value name="string" type="STRING">review</value>
                                <value name="string" type="STRING">mainArticle</value>
                                <value name="string" type="STRING">editorial</value>
                                <value name="string" type="STRING">obituary</value>
                                <value name="string" type="STRING">bibliographicalPortrait</value>
                                <value name="string" type="STRING">colophon</value>
                                <value name="string" type="STRING">interview</value>
                                <value name="string" type="STRING">anotation</value>
                            </params>
                        </evaluation>
                    </value>
                </params>
            </validation>
        </rule>

        <rule name="SECONDARY-METS_PHYSICAL_STRUCTURAL_MAP_CORRECT">
            <description>Fyzická strukturální mapa v každém souboru SECONDARY-METS musí odkazovat všechny soubory
                odkazované v elementu fileSec a žádné jiné.
            </description>
            <validation functionName="checkSecondaryMetsPhysicalMapOk">
                <params>
                    <value name="secondary-mets_files" type="FILE_LIST">
                        <value-ref name="SECONDARY-METS_FILES"/>
                    </value>
                    <value name="expected_page_type" type="STRING">PERIODICAL_PAGE</value>
                    <value name="filegroups_to_check" type="STRING_LIST">
                        <evaluation functionName="buildListOfStrings">
                            <params>
                                <value name="string" type="STRING">MC_IMGGRP</value>
                                <!--O UC se DMF nezminuje, ale v realnych zaznamech se vyskytuji, takze asi "chyba v DMF"-->
                                <value name="string" type="STRING">UC_IMGGRP</value>
                                <value name="string" type="STRING">ALTOGRP</value>
                                <value name="string" type="STRING">TXTGRP</value>
                            </params>
                        </evaluation>
                    </value>
                </params>
            </validation>
        </rule>

    </rules-section>

    <rules-section name="Obrazová data"
                   description="Kontrola obrázků MASTER-COPY a USER-COPY v JPEG 2000 za pomocí externích nástrojů">

        <rule name="MASTER-COPY_FILES_VALID_BY_JPYLYZER">
            <description>Všechny soubory MASTER-COPY (jpeg 2000) musí být validní vůči profilu pro binární soubory pro nástroj Jpylyzer.
            </description>
            <validation functionName="checkBinaryFilesValidByExternalUtil">
                <params>
                    <value name="files" type="FILE_LIST">
                        <value-ref name="MASTER-COPY_FILES"/>
                    </value>
                    <value name="type" type="RESOURCE_TYPE">IMAGE_MASTER_COPY</value>
                    <value name="util" type="EXTERNAL_UTIL">JPYLYZER</value>
                    <value name="execution" type="STRING">jp2k</value>
                </params>
            </validation>
        </rule>

        <rule name="USER-COPY_FILES_VALID_BY_JPYLYZER">
            <description>Všechny soubory USER-COPY (jpeg 2000) musí být validní vůči profilu pro binární soubory pro nástroj Jpylyzer.
            </description>
            <validation functionName="checkBinaryFilesValidByExternalUtil">
                <params>
                    <value name="files" type="FILE_LIST">
                        <value-ref name="USER-COPY_FILES"/>
                    </value>
                    <value name="type" type="RESOURCE_TYPE">IMAGE_USER_COPY</value>
                    <value name="util" type="EXTERNAL_UTIL">JPYLYZER</value>
                    <value name="execution" type="STRING">jp2k</value>
                </params>
            </validation>
        </rule>

        <rule name="MASTER-COPY_FILES_VALID_BY_JHOVE">
            <description>Všechny soubory MASTER-COPY (jpeg 2000) musí být validní vůči profilu pro binární soubory pro nástroj JHOVE.
            </description>
            <validation functionName="checkBinaryFilesValidByExternalUtil">
                <params>
                    <value name="files" type="FILE_LIST">
                        <value-ref name="MASTER-COPY_FILES"/>
                    </value>
                    <value name="type" type="RESOURCE_TYPE">IMAGE_MASTER_COPY</value>
                    <value name="util" type="EXTERNAL_UTIL">JHOVE</value>
                    <value name="execution" type="STRING">jp2k</value>
                </params>
            </validation>
        </rule>

        <rule name="USER-COPY_FILES_VALID_BY_JHOVE">
            <description>Všechny soubory USER-COPY (jpeg 2000) musí být validní vůči profilu pro binární soubory pro nástroj JHOVE.
            </description>
            <validation functionName="checkBinaryFilesValidByExternalUtil">
                <params>
                    <value name="files" type="FILE_LIST">
                        <value-ref name="USER-COPY_FILES"/>
                    </value>
                    <value name="type" type="RESOURCE_TYPE">IMAGE_USER_COPY</value>
                    <value name="util" type="EXTERNAL_UTIL">JHOVE</value>
                    <value name="execution" type="STRING">jp2k</value>
                </params>
            </validation>
        </rule>

        <rule name="MASTER-COPY_FILES_VALID_BY_KAKADU">
            <description>Všechny soubory MASTER-COPY (jpeg 2000) musí být validní vůči profilu pro binární soubory pro nástroj Kakadu.
            </description>
            <validation functionName="checkBinaryFilesValidByExternalUtil">
                <params>
                    <value name="files" type="FILE_LIST">
                        <value-ref name="MASTER-COPY_FILES"/>
                    </value>
                    <value name="type" type="RESOURCE_TYPE">IMAGE_MASTER_COPY</value>
                    <value name="util" type="EXTERNAL_UTIL">KAKADU</value>
                    <value name="execution" type="STRING">jp2k</value>
                </params>
            </validation>
        </rule>

        <rule name="USER-COPY_FILES_VALID_BY_KAKADU">
            <description>Všechny soubory USER-COPY (jpeg 2000) musí být validní vůči profilu pro binární soubory pro nástroj Kakadu.
            </description>
            <validation functionName="checkBinaryFilesValidByExternalUtil">
                <params>
                    <value name="files" type="FILE_LIST">
                        <value-ref name="USER-COPY_FILES"/>
                    </value>
                    <value name="type" type="RESOURCE_TYPE">IMAGE_USER_COPY</value>
                    <value name="util" type="EXTERNAL_UTIL">KAKADU</value>
                    <value name="execution" type="STRING">jp2k</value>
                </params>
            </validation>
        </rule>

        <rule name="MASTER-COPY_FILES_VALID_BY_IMAGE_MAGICK">
            <description>Všechny soubory MASTER-COPY (jpeg 2000) musí být validní vůči profilu pro binární soubory pro nástroj ImageMagick.
            </description>
            <validation functionName="checkBinaryFilesValidByExternalUtil">
                <params>
                    <value name="files" type="FILE_LIST">
                        <value-ref name="MASTER-COPY_FILES"/>
                    </value>
                    <value name="type" type="RESOURCE_TYPE">IMAGE_MASTER_COPY</value>
                    <value name="util" type="EXTERNAL_UTIL">IMAGE_MAGICK</value>
                    <value name="execution" type="STRING">jp2k</value>
                </params>
            </validation>
        </rule>

        <rule name="USER-COPY_FILES_VALID_BY_IMAGE_MAGICK">
            <description>Všechny soubory USER-COPY (jpeg 2000) musí být validní vůči profilu pro binární soubory pro nástroj ImageMagick.
            </description>
            <validation functionName="checkBinaryFilesValidByExternalUtil">
                <params>
                    <value name="files" type="FILE_LIST">
                        <value-ref name="USER-COPY_FILES"/>
                    </value>
                    <value name="type" type="RESOURCE_TYPE">IMAGE_USER_COPY</value>
                    <value name="util" type="EXTERNAL_UTIL">IMAGE_MAGICK</value>
                    <value name="execution" type="STRING">jp2k</value>
                </params>
            </validation>
        </rule>

    </rules-section>

    <rules-section name="Bibliografická metadata"
                   description="validace obsahů bibliografických metadat v MODS a Dubline Core v souboru PRIMARY-METS">

        <rule name="BIBLIOGRAPHIC_METADATA_MATCH_PROFILE_TITLE">
            <description>Bibliografická metadata pro entitu typu TITLE musí splňovat požadovaný profil pro záznamy v
                Dublin Core i MODS.
            </description>
            <validation functionName="checkBibliographicMetadataMatchProfile">
                <params>
                    <value name="mets_file" type="FILE">
                        <value-ref name="PRIMARY-METS_FILE"/>
                    </value>
                    <value name="entity_type" type="ENTITY_TYPE">TITLE</value>
                    <value name="profile_detection_xpath" type="STRING">concat('title',null)</value>
                    <value name="xsd_file_dc" type="FILE">
                        <value-ref name="DC_XSD_FILE"/>
                    </value>
                    <value name="xsd_file_mods" type="FILE">
                        <value-ref name="MODS_XSD_FILE"/>
                    </value>
                </params>
            </validation>
        </rule>

        <rule name="BIBLIOGRAPHIC_METADATA_MATCH_PROFILE_VOLUME">
            <description>Bibliografická metadata pro entitu typu VOLUME musí splňovat požadovaný profil pro záznamy v
                Dublin Core i MODS.
            </description>
            <validation functionName="checkBibliographicMetadataMatchProfile">
                <params>
                    <value name="mets_file" type="FILE">
                        <value-ref name="PRIMARY-METS_FILE"/>
                    </value>
                    <value name="entity_type" type="ENTITY_TYPE">VOLUME</value>
                    <value name="profile_detection_xpath" type="STRING">concat('volume',null)</value>
                    <value name="xsd_file_dc" type="FILE">
                        <value-ref name="DC_XSD_FILE"/>
                    </value>
                    <value name="xsd_file_mods" type="FILE">
                        <value-ref name="MODS_XSD_FILE"/>
                    </value>
                </params>
            </validation>
        </rule>

        <rule name="BIBLIOGRAPHIC_METADATA_MATCH_PROFILE_ISSUE">
            <description>Bibliografická metadata pro entitu typu ISSUE musí splňovat požadovaný profil pro záznamy v
                Dublin Core i MODS.
            </description>
            <validation functionName="checkBibliographicMetadataMatchProfile">
                <params>
                    <value name="mets_file" type="FILE">
                        <value-ref name="PRIMARY-METS_FILE"/>
                    </value>
                    <value name="entity_type" type="ENTITY_TYPE">ISSUE</value>
                    <value name="profile_detection_xpath" type="STRING">concat('issue',null)</value>
                    <value name="xsd_file_dc" type="FILE">
                        <value-ref name="DC_XSD_FILE"/>
                    </value>
                    <value name="xsd_file_mods" type="FILE">
                        <value-ref name="MODS_XSD_FILE"/>
                    </value>
                </params>
            </validation>
        </rule>

        <rule name="BIBLIOGRAPHIC_METADATA_MATCH_PROFILE_SUPPLEMENT">
            <description>Bibliografická metadata pro entitu typu SUPPLEMENT musí splňovat požadovaný profil pro záznamy
                v Dublin Core i MODS.
            </description>
            <validation functionName="checkBibliographicMetadataMatchProfile">
                <params>
                    <value name="mets_file" type="FILE">
                        <value-ref name="PRIMARY-METS_FILE"/>
                    </value>
                    <value name="entity_type" type="ENTITY_TYPE">SUPPLEMENT</value>
                    <value name="profile_detection_xpath" type="STRING">concat('supplement',null)</value>
                    <value name="xsd_file_dc" type="FILE">
                        <value-ref name="DC_XSD_FILE"/>
                    </value>
                    <value name="xsd_file_mods" type="FILE">
                        <value-ref name="MODS_XSD_FILE"/>
                    </value>
                </params>
            </validation>
        </rule>

        <rule name="BIBLIOGRAPHIC_METADATA_MATCH_PROFILE_PICTURE">
            <description>Bibliografická metadata pro entitu typu PICTURE musí splňovat požadovaný profil pro záznamy
                v Dublin Core i MODS.
            </description>
            <validation functionName="checkBibliographicMetadataMatchProfile">
                <params>
                    <value name="mets_file" type="FILE">
                        <value-ref name="PRIMARY-METS_FILE"/>
                    </value>
                    <value name="entity_type" type="ENTITY_TYPE">PICTURE</value>
                    <value name="profile_detection_xpath" type="STRING">concat('internalpart_picture',null)</value>
                    <value name="xsd_file_dc" type="FILE">
                        <value-ref name="DC_XSD_FILE"/>
                    </value>
                    <value name="xsd_file_mods" type="FILE">
                        <value-ref name="MODS_XSD_FILE"/>
                    </value>
                </params>
            </validation>
        </rule>

        <rule name="BIBLIOGRAPHIC_METADATA_MATCH_PROFILE_ARTICLE">
            <description>Bibliografická metadata pro entitu typu ARTICLE musí splňovat požadovaný profil pro záznamy
                v Dublin Core i MODS.
            </description>
            <validation functionName="checkBibliographicMetadataMatchProfile">
                <params>
                    <value name="mets_file" type="FILE">
                        <value-ref name="PRIMARY-METS_FILE"/>
                    </value>
                    <value name="entity_type" type="ENTITY_TYPE">ARTICLE</value>
                    <value name="profile_detection_xpath" type="STRING">concat('internalpart_article',null)</value>
                    <value name="xsd_file_dc" type="FILE">
                        <value-ref name="DC_XSD_FILE"/>
                    </value>
                    <value name="xsd_file_mods" type="FILE">
                        <value-ref name="MODS_XSD_FILE"/>
                    </value>
                </params>
            </validation>
        </rule>

        <rule name="BIBLIOGRAPHIC_METADATA_MATCH_PROFILE_PAGE">
            <description>Bibliografická metadata pro entitu typu PAGE musí splňovat požadovaný profil pro záznamy
                v Dublin Core i MODS.
            </description>
            <validation functionName="checkBibliographicMetadataMatchProfile">
                <params>
                    <value name="mets_file" type="FILE">
                        <value-ref name="PRIMARY-METS_FILE"/>
                    </value>
                    <value name="entity_type" type="ENTITY_TYPE">PAGE</value>
                    <value name="profile_detection_xpath" type="STRING">concat('page',null)</value>
                    <value name="xsd_file_dc" type="FILE">
                        <value-ref name="DC_XSD_FILE"/>
                    </value>
                    <value name="xsd_file_mods" type="FILE">
                        <value-ref name="MODS_XSD_FILE"/>
                    </value>
                </params>
            </validation>
        </rule>

    </rules-section>

    <rules-section name="OCR ALTO" description="Kontrola souborů ALTO.">

        <!--   <rule name="ALTO_FILES_VALID_BY_XSD">
               <description>Soubory OCR-ALTO musí být validní podle XML Schema (alto_2.0.xsd).</description>
               <validation functionName="checkXmlIsValidByXsd">
                   <params>
                       <value name="xml_files" type="FILE_LIST">
                           <value-ref name="OCR-ALTO_FILES"/>
                       </value>
                       <value name="xsd_file" type="FILE">
                           <value-ref name="ALTO_XSD_FILE"/>
                       </value>
                       <value name="level" type="LEVEL">ERROR</value>
                   </params>
               </validation>
           </rule>-->

    </rules-section>

    <rules-section name="Technická metadata" description="Kontrola technických (MIX, PREMIS) metadat.">

        <rule name="MIX_VALID_BY_XSD">
            <description>Záznamy MIX v souborech SECONDARY-METS musí být validní podle XML Schema (mix_2.0.xsd).
            </description>
            <validation functionName="checkMixIsValidByXsd">
                <params>
                    <value name="mets_files" type="FILE_LIST">
                        <value-ref name="SECONDARY-METS_FILES"/>
                    </value>
                    <value name="xsd_file" type="FILE">
                        <value-ref name="MIX_XSD_FILE"/>
                    </value>
                    <value name="level" type="LEVEL">ERROR</value>
                </params>
            </validation>
        </rule>

        <rule name="MIX_FOR_ORIGINAL_SCAN_MATCHES_PROFILE">
            <description>Záznamy MIX v souborech SECONDARY-METS pro původní skeny musí splňovat profil.</description>
            <validation functionName="checkMetsAmdsecElementsMatchProfile">
                <params>
                    <value name="mets_files" type="FILE_LIST">
                        <value-ref name="SECONDARY-METS_FILES"/>
                    </value>
                    <value name="element_xpath" type="STRING">mets:techMD[@ID="MIX_001"]</value>
                    <value name="element_must_exist" type="BOOLEAN">true</value>
                    <value name="profile_id" type="STRING">mix_ps</value>
                </params>
            </validation>
        </rule>

        <rule name="MIX_FOR_FIRST_MASTER_COPY_MATCHES_PROFILE">
            <description>Záznamy MIX v souborech SECONDARY-METS pro první verze archivních kopií musí splňovat profil.
            </description>
            <validation functionName="checkMetsAmdsecElementsMatchProfile">
                <params>
                    <value name="mets_files" type="FILE_LIST">
                        <value-ref name="SECONDARY-METS_FILES"/>
                    </value>
                    <value name="element_xpath" type="STRING">mets:techMD[@ID="MIX_002"]</value>
                    <value name="element_must_exist" type="BOOLEAN">true</value>
                    <value name="profile_id" type="STRING">mix_mc</value>
                </params>
            </validation>
        </rule>

        <rule name="MIX_FOR_OTHER_MASTER_COPIES_MATCHES_PROFILE">
            <description>Záznamy MIX v souborech SECONDARY-METS pro další verze archivních kopií, pokud existují, musí
                splňovat profil.
            </description>
            <validation functionName="checkMetsAmdsecElementsMatchProfile">
                <params>
                    <value name="mets_files" type="FILE_LIST">
                        <value-ref name="SECONDARY-METS_FILES"/>
                    </value>
                    <value name="element_xpath" type="STRING">mets:techMD[not(@ID="MIX_001") and not(@ID="MIX_002") and
                        starts-with(@ID,"MIX_")]
                    </value>
                    <value name="element_must_exist" type="BOOLEAN">false</value>
                    <value name="profile_id" type="STRING">mix_mc</value>
                </params>
            </validation>
        </rule>

        <rule name="PREMIS_VALID_BY_XSD">
            <description>Záznamy PREMIS v souborech SECONDARY-METS musí být validní podle XML Schema (premis_2.2.xsd).
            </description>
            <validation functionName="checkPremisIsValidByXsd">
                <params>
                    <value name="mets_files" type="FILE_LIST">
                        <value-ref name="SECONDARY-METS_FILES"/>
                    </value>
                    <value name="xsd_file" type="FILE">
                        <value-ref name="PREMIS_XSD_FILE"/>
                    </value>
                    <value name="level" type="LEVEL">ERROR</value>
                </params>
            </validation>
        </rule>

        <rule name="PREMIS_OBJECT_FOR_ORIGINAL_SCAN_MATCHES_PROFILE">
            <description>Záznamy PREMIS Object v souborech SECONDARY-METS pro původní skeny musí splňovat profil.
            </description>
            <validation functionName="checkMetsAmdsecElementsMatchProfile">
                <params>
                    <value name="mets_files" type="FILE_LIST">
                        <value-ref name="SECONDARY-METS_FILES"/>
                    </value>
                    <value name="element_xpath" type="STRING">mets:techMD[@ID="OBJ_001"]</value>
                    <value name="element_must_exist" type="BOOLEAN">true</value>
                    <value name="profile_id" type="STRING">premis_object_ps</value>
                </params>
            </validation>
        </rule>

        <rule name="PREMIS_OBJECT_FOR_MASTER_COPY_MATCHES_PROFILE">
            <description>Záznamy PREMIS Object v souborech SECONDARY-METS pro archivní kopie musí splňovat profil.
            </description>
            <validation functionName="checkMetsAmdsecElementsMatchProfile">
                <params>
                    <value name="mets_files" type="FILE_LIST">
                        <value-ref name="SECONDARY-METS_FILES"/>
                    </value>
                    <value name="element_xpath" type="STRING">mets:techMD[@ID="OBJ_002"]</value>
                    <value name="element_must_exist" type="BOOLEAN">true</value>
                    <value name="profile_id" type="STRING">premis_object_mc</value>
                </params>
            </validation>
        </rule>

        <rule name="PREMIS_OBJECT_FOR_ALTO_OCR_MATCHES_PROFILE">
            <description>Záznamy PREMIS Object v souborech SECONDARY-METS pro ALTO OCR musí splňovat profil.
            </description>
            <validation functionName="checkMetsAmdsecElementsMatchProfile">
                <params>
                    <value name="mets_files" type="FILE_LIST">
                        <value-ref name="SECONDARY-METS_FILES"/>
                    </value>
                    <value name="element_xpath" type="STRING">mets:techMD[@ID="OBJ_003"]</value>
                    <value name="element_must_exist" type="BOOLEAN">true</value>
                    <value name="profile_id" type="STRING">premis_object_alto</value>
                </params>
            </validation>
        </rule>

        <rule name="PREMIS_EVENT_MATCHES_PROFILE">
            <description>Záznamy PREMIS Event v souborech SECONDARY-METS musí splňovat profil.
            </description>
            <validation functionName="checkMetsAmdsecElementsMatchProfile">
                <params>
                    <value name="mets_files" type="FILE_LIST">
                        <value-ref name="SECONDARY-METS_FILES"/>
                    </value>
                    <value name="element_xpath" type="STRING">mets:digiprovMD[starts-with(@ID,"EVT_")]</value>
                    <value name="element_must_exist" type="BOOLEAN">true</value>
                    <value name="profile_id" type="STRING">premis_event</value>
                </params>
            </validation>
        </rule>

        <rule name="PREMIS_AGENT_MATCHES_PROFILE">
            <description>Záznamy PREMIS Event v souborech SECONDARY-METS musí splňovat profil.
            </description>
            <validation functionName="checkMetsAmdsecElementsMatchProfile">
                <params>
                    <value name="mets_files" type="FILE_LIST">
                        <value-ref name="SECONDARY-METS_FILES"/>
                    </value>
                    <value name="element_xpath" type="STRING">mets:digiprovMD[starts-with(@ID,"AGENT_")]</value>
                    <value name="element_must_exist" type="BOOLEAN">true</value>
                    <value name="profile_id" type="STRING">premis_agent</value>
                </params>
            </validation>
        </rule>

        <rule name="PREMIS_LINKING_CORRECT">
            <description>Odkazy mezi PREMIS Objekty, Událostmi a Agenty musí být korektní a úplné.</description>
            <validation functionName="checkPremisLinks">
                <params>
                    <value name="mets_files" type="FILE_LIST">
                        <value-ref name="SECONDARY-METS_FILES"/>
                    </value>
                </params>
            </validation>
        </rule>

    </rules-section>

    <rules-section name="Autorskoprávní metadata" description="Kontrola autorskoprávních (CopyrightMD) metadat.">

        <rule name="COPYRIGHTMD_VALID_BY_XSD">
            <description>Záznamy CopyrightMD v souboru PRIMARY-METS a souborech SECONDARY-METS musí být validní podle
                XML Schema (cmd_0.91.xsd).
            </description>
            <validation functionName="checkCopyrightMdIsValidByXsd">
                <params>
                    <value name="mets_file" type="FILE">
                        <value-ref name="PRIMARY-METS_FILE"/>
                    </value>
                    <value name="mets_files" type="FILE_LIST">
                        <value-ref name="SECONDARY-METS_FILES"/>
                    </value>
                    <value name="xsd_file" type="FILE">
                        <value-ref name="CMD_XSD_FILE"/>
                    </value>
                    <value name="level" type="LEVEL">ERROR</value>
                </params>
            </validation>
        </rule>

        <rule name="COPYRIGHTMD_IN_SECONDARY_METS_MATCH_PROFILE">
            <description>Záznamy CopyrightMD v souborech SECONDARY-METS, pokud existují, musí splňovat profil.
            </description>
            <validation functionName="checkMetsAmdsecElementsMatchProfile">
                <params>
                    <value name="mets_files" type="FILE_LIST">
                        <value-ref name="SECONDARY-METS_FILES"/>
                    </value>
                    <value name="element_xpath" type="STRING">mets:rightsMD</value>
                    <value name="element_must_exist" type="BOOLEAN">false</value>
                    <value name="profile_id" type="STRING">copyrightmd</value>
                </params>
            </validation>
        </rule>

        <rule name="COPYRIGHTMD_IN_PRIMARY_METS_MATCH_PROFILE">
            <description>Záznamy CopyrightMD v souboru PRIMARY-METS, pokud existují, musí splňovat profil.
            </description>
            <validation functionName="checkMetsAmdsecElementsMatchProfile">
                <params>
                    <value name="mets_file" type="FILE">
                        <value-ref name="PRIMARY-METS_FILE"/>
                    </value>
                    <value name="element_xpath" type="STRING">mets:rightsMD</value>
                    <value name="element_must_exist" type="BOOLEAN">false</value>
                    <value name="profile_id" type="STRING">copyrightmd</value>
                </params>
            </validation>
        </rule>

    </rules-section>

</fDMF>